{"repository": {"owner": {"login": "systemd"}, "name": "systemd", "forkCount": 2494, "stargazerCount": 7830, "createdAt": "2015-03-25T15:27:27Z", "updatedAt": "2021-03-10T22:55:53Z", "repositoryTopics": {"edges": [{"node": {"topic": {"name": "systemd"}}}, {"node": {"topic": {"name": "c"}}}, {"node": {"topic": {"name": "linux"}}}, {"node": {"topic": {"name": "init"}}}, {"node": {"topic": {"name": "services"}}}, {"node": {"topic": {"name": "system"}}}]}, "languages": {"edges": [{"node": {"name": "Emacs Lisp"}}, {"node": {"name": "Vim script"}}, {"node": {"name": "Python"}}, {"node": {"name": "Makefile"}}, {"node": {"name": "Shell"}}, {"node": {"name": "Meson"}}, {"node": {"name": "M4"}}, {"node": {"name": "Perl"}}, {"node": {"name": "C"}}, {"node": {"name": "Awk"}}, {"node": {"name": "C++"}}, {"node": {"name": "Objective-C"}}, {"node": {"name": "HTML"}}, {"node": {"name": "sed"}}, {"node": {"name": "SmPL"}}, {"node": {"name": "CodeQL"}}]}, "primaryLanguage": {"name": "C"}}, "id": "MDU6SXNzdWU2ODQ1NjYyOTA=", "number": 16825, "author": {"login": "nixbitcoin"}, "title": "GetUnitProcesses should only show info for the current user's unit when /proc access is restricted", "body": "**systemd version the issue has been seen with**\r\n> systemd 243\r\n\r\n<!-- **NOTE:** Do not submit bug reports about anything but the two most recently released (non-rc) systemd versions upstream! -->\r\n<!-- See https://github.com/systemd/systemd/releases for the list of most recent releases. -->\r\n<!-- For older version please use distribution trackers (see https://systemd.io/CONTRIBUTING#filing-issues). -->\r\n\r\n**Used distribution**\r\n > NixOS 20.03\r\n\r\n**Expected behaviour you didn't see**\r\n > `systemctl status <service name>` should only show `CGroup` information for the current user's unit when `/proc` access is restricted\r\n\r\n**Unexpected behaviour you saw**\r\n > When run from a less-privileged user  `systemctl status <service name>` shows `CGroup` information for other less-privileged user's units.\r\n\r\n**Steps to reproduce the problem**\r\n1. Set `hidepid=2`\r\n2. Run a unit that places secrets in command line arguments like [c-lightning](https://github.com/elementsproject/lightning)\r\n3. In the first few seconds of start up run `systemctl status clightning` and see how it leaks bitcoind rpc passwords while connecting to bitcoind\r\n\r\nOf course, this should also be fixed upstream but I think it would be a general security improvement to restrict current user's access to process information when `/proc` access is restricted.\r\n", "bodyHTML": "<p><strong>systemd version the issue has been seen with</strong></p>\n<blockquote>\n<p>systemd 243</p>\n</blockquote>\n\n\n\n<p><strong>Used distribution</strong></p>\n<blockquote>\n<p>NixOS 20.03</p>\n</blockquote>\n<p><strong>Expected behaviour you didn't see</strong></p>\n<blockquote>\n<p><code>systemctl status &lt;service name&gt;</code> should only show <code>CGroup</code> information for the current user's unit when <code>/proc</code> access is restricted</p>\n</blockquote>\n<p><strong>Unexpected behaviour you saw</strong></p>\n<blockquote>\n<p>When run from a less-privileged user  <code>systemctl status &lt;service name&gt;</code> shows <code>CGroup</code> information for other less-privileged user's units.</p>\n</blockquote>\n<p><strong>Steps to reproduce the problem</strong></p>\n<ol>\n<li>Set <code>hidepid=2</code></li>\n<li>Run a unit that places secrets in command line arguments like <a href=\"https://github.com/elementsproject/lightning\">c-lightning</a></li>\n<li>In the first few seconds of start up run <code>systemctl status clightning</code> and see how it leaks bitcoind rpc passwords while connecting to bitcoind</li>\n</ol>\n<p>Of course, this should also be fixed upstream but I think it would be a general security improvement to restrict current user's access to process information when <code>/proc</code> access is restricted.</p>", "bodyText": "systemd version the issue has been seen with\n\nsystemd 243\n\n\n\n\nUsed distribution\n\nNixOS 20.03\n\nExpected behaviour you didn't see\n\nsystemctl status <service name> should only show CGroup information for the current user's unit when /proc access is restricted\n\nUnexpected behaviour you saw\n\nWhen run from a less-privileged user  systemctl status <service name> shows CGroup information for other less-privileged user's units.\n\nSteps to reproduce the problem\n\nSet hidepid=2\nRun a unit that places secrets in command line arguments like c-lightning\nIn the first few seconds of start up run systemctl status clightning and see how it leaks bitcoind rpc passwords while connecting to bitcoind\n\nOf course, this should also be fixed upstream but I think it would be a general security improvement to restrict current user's access to process information when /proc access is restricted.", "assignees": {"edges": []}, "createdAt": "2020-08-24T10:47:25Z", "closed": true, "closedAt": "2020-08-24T16:21:03Z", "lastEditedAt": null, "publishedAt": "2020-08-24T10:47:25Z", "comments": {"totalCount": 1, "edges": [{"node": {"id": "MDEyOklzc3VlQ29tbWVudDY3OTIyODU3MA==", "author": {"login": "poettering"}, "body": "We do not support hidepid= on the host `/proc`, sorry. This cannot work. Please see #16681 for a per-service hookup for this.\r\n\r\nDuplicate of #12955 with further info why this is not supportable for the main host `/proc/`", "bodyText": "We do not support hidepid= on the host /proc, sorry. This cannot work. Please see #16681 for a per-service hookup for this.\nDuplicate of #12955 with further info why this is not supportable for the main host /proc/", "bodyHTML": "<p>We do not support hidepid= on the host <code>/proc</code>, sorry. This cannot work. Please see <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"674324337\" data-permission-text=\"Title is private\" data-url=\"https://github.com/systemd/systemd/issues/16681\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/systemd/systemd/pull/16681/hovercard\" href=\"https://github.com/systemd/systemd/pull/16681\">#16681</a> for a per-service hookup for this.</p>\n<p>Duplicate of <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"464186465\" data-permission-text=\"Title is private\" data-url=\"https://github.com/systemd/systemd/issues/12955\" data-hovercard-type=\"issue\" data-hovercard-url=\"/systemd/systemd/issues/12955/hovercard\" href=\"https://github.com/systemd/systemd/issues/12955\">#12955</a> with further info why this is not supportable for the main host <code>/proc/</code></p>", "createdAt": "2020-08-24T16:21:03Z", "publishedAt": "2020-08-24T16:21:03Z", "lastEditedAt": null, "updatedAt": "2020-08-24T16:21:03Z", "reactions": {"edges": []}, "bodyParsed": [{"number": 31953, "isCode": false, "isBlockQuote": false, "blockQuoteDepth": 0, "sent": "We do not support hidepid= on the host /proc, sorry.", "sentSegmented": ["we", "do", "not", "support", "hidepid=", "on", "the", "host", "/proc", "sorry"], "sentSegmentedWithoutStops": ["support", "hidepid=", "host", "/proc", "sorry"], "sentSegmentedWithoutStopsStemmed": ["support", "hidepid=", "host", "/proc", "sorri"]}, {"number": 31954, "isCode": false, "isBlockQuote": false, "blockQuoteDepth": 0, "sent": "This cannot work.", "sentSegmented": ["this", "can", "not", "work"], "sentSegmentedWithoutStops": ["work"], "sentSegmentedWithoutStopsStemmed": ["work"]}, {"number": 31955, "isCode": false, "isBlockQuote": false, "blockQuoteDepth": 0, "sent": "Please see #16681 for a per-service hookup for this.", "sentSegmented": ["please", "see", "16681", "for", "a", "per-service", "hookup", "for", "this"], "sentSegmentedWithoutStops": ["please", "see", "16681", "per-service", "hookup"], "sentSegmentedWithoutStopsStemmed": ["pleas", "see", "16681", "per-servic", "hookup"]}, {"number": 31956, "isCode": false, "isBlockQuote": false, "blockQuoteDepth": 0, "sent": "Duplicate of #12955 with further info why this is not supportable for the main host /proc/", "sentSegmented": ["duplicate", "of", "12955", "with", "further", "info", "why", "this", "is", "not", "supportable", "for", "the", "main", "host", "/proc/"], "sentSegmentedWithoutStops": ["duplicate", "12955", "info", "supportable", "main", "host", "/proc/"], "sentSegmentedWithoutStopsStemmed": ["duplic", "12955", "info", "support", "main", "host", "/proc/"]}]}}], "pageInfo": {"endCursor": "Y3Vyc29yOnYyOpHOKHw0mg==", "hasNextPage": false}}, "labels": {"edges": [{"node": {"createdAt": "2015-08-26T15:17:59Z", "name": "not-supported"}}, {"node": {"createdAt": "2015-06-08T16:26:48Z", "name": "pid1"}}]}, "milestone": null, "reactions": {"edges": []}, "state": "CLOSED", "titleSegmented": ["getunitprocesses", "should", "only", "show", "info", "for", "the", "current", "user", "'s", "unit", "when", "/proc", "access", "is", "restricted"], "titleSegmentedWithoutStops": ["getunitprocesses", "show", "info", "current", "user", "'s", "unit", "/proc", "access", "restricted"], "titleSegmentedWithoutStopsStemmed": ["getunitprocess", "show", "info", "current", "user", "'s", "unit", "/proc", "access", "restrict"], "bodyParsed": [{"number": 31940, "isCode": false, "isBlockQuote": false, "blockQuoteDepth": 0, "sent": "systemd version the issue has been seen with", "sentSegmented": ["systemd", "version", "the", "issue", "has", "been", "seen", "with"], "sentSegmentedWithoutStops": ["systemd", "version", "issue", "seen"], "sentSegmentedWithoutStopsStemmed": ["systemd", "version", "issu", "seen"]}, {"number": 31941, "isCode": false, "isBlockQuote": true, "blockQuoteDepth": 1, "sent": "systemd 243", "sentSegmented": ["systemd", "243"], "sentSegmentedWithoutStops": ["systemd", "243"], "sentSegmentedWithoutStopsStemmed": ["systemd", "243"]}, {"number": 31942, "isCode": false, "isBlockQuote": false, "blockQuoteDepth": 0, "sent": "Used distribution", "sentSegmented": ["used", "distribution"], "sentSegmentedWithoutStops": ["used", "distribution"], "sentSegmentedWithoutStopsStemmed": ["use", "distribut"]}, {"number": 31943, "isCode": false, "isBlockQuote": true, "blockQuoteDepth": 1, "sent": "NixOS 20.03", "sentSegmented": ["nixos", "20.03"], "sentSegmentedWithoutStops": ["nixos", "20.03"], "sentSegmentedWithoutStopsStemmed": ["nixo", "20.03"]}, {"number": 31944, "isCode": false, "isBlockQuote": false, "blockQuoteDepth": 0, "sent": "Expected behaviour you didn't see", "sentSegmented": ["expected", "behaviour", "you", "did", "n't", "see"], "sentSegmentedWithoutStops": ["expected", "behaviour", "n't", "see"], "sentSegmentedWithoutStopsStemmed": ["expect", "behaviour", "n't", "see"]}, {"number": 31945, "isCode": false, "isBlockQuote": true, "blockQuoteDepth": 1, "sent": "systemctl status  should only show CGroup information for the current user's unit when /proc access is restricted", "sentSegmented": ["systemctl", "status", "should", "only", "show", "cgroup", "information", "for", "the", "current", "user", "'s", "unit", "when", "/proc", "access", "is", "restricted"], "sentSegmentedWithoutStops": ["systemctl", "status", "show", "cgroup", "information", "current", "user", "'s", "unit", "/proc", "access", "restricted"], "sentSegmentedWithoutStopsStemmed": ["systemctl", "statu", "show", "cgroup", "inform", "current", "user", "'s", "unit", "/proc", "access", "restrict"]}, {"number": 31946, "isCode": false, "isBlockQuote": false, "blockQuoteDepth": 0, "sent": "Unexpected behaviour you saw", "sentSegmented": ["unexpected", "behaviour", "you", "saw"], "sentSegmentedWithoutStops": ["unexpected", "behaviour", "saw"], "sentSegmentedWithoutStopsStemmed": ["unexpect", "behaviour", "saw"]}, {"number": 31947, "isCode": false, "isBlockQuote": true, "blockQuoteDepth": 1, "sent": "When run from a less-privileged user  systemctl status  shows CGroup information for other less-privileged user's units.", "sentSegmented": ["when", "run", "from", "a", "less-privileged", "user", "systemctl", "status", "shows", "cgroup", "information", "for", "other", "less-privileged", "user", "'s", "units"], "sentSegmentedWithoutStops": ["run", "less-privileged", "user", "systemctl", "status", "shows", "cgroup", "information", "less-privileged", "user", "'s", "units"], "sentSegmentedWithoutStopsStemmed": ["run", "less-privileg", "user", "systemctl", "statu", "show", "cgroup", "inform", "less-privileg", "user", "'s", "unit"]}, {"number": 31948, "isCode": false, "isBlockQuote": false, "blockQuoteDepth": 0, "sent": "Steps to reproduce the problem", "sentSegmented": ["steps", "to", "reproduce", "the", "problem"], "sentSegmentedWithoutStops": ["steps", "reproduce", "problem"], "sentSegmentedWithoutStopsStemmed": ["step", "reproduc", "problem"]}, {"number": 31949, "isCode": false, "isBlockQuote": false, "blockQuoteDepth": 0, "sent": "Set hidepid=2", "sentSegmented": ["set", "hidepid=2"], "sentSegmentedWithoutStops": ["set", "hidepid=2"], "sentSegmentedWithoutStopsStemmed": ["set", "hidepid=2"]}, {"number": 31950, "isCode": false, "isBlockQuote": false, "blockQuoteDepth": 0, "sent": "Run a unit that places secrets in command line arguments like c-lightning", "sentSegmented": ["run", "a", "unit", "that", "places", "secrets", "in", "command", "line", "arguments", "like", "c-lightning"], "sentSegmentedWithoutStops": ["run", "unit", "places", "secrets", "command", "line", "arguments", "like", "c-lightning"], "sentSegmentedWithoutStopsStemmed": ["run", "unit", "place", "secret", "command", "line", "argument", "like", "c-lightn"]}, {"number": 31951, "isCode": false, "isBlockQuote": false, "blockQuoteDepth": 0, "sent": "In the first few seconds of start up run systemctl status clightning and see how it leaks bitcoind rpc passwords while connecting to bitcoind", "sentSegmented": ["in", "the", "first", "few", "seconds", "of", "start", "up", "run", "systemctl", "status", "clightning", "and", "see", "how", "it", "leaks", "bitcoind", "rpc", "passwords", "while", "connecting", "to", "bitcoind"], "sentSegmentedWithoutStops": ["first", "seconds", "start", "run", "systemctl", "status", "clightning", "see", "leaks", "bitcoind", "rpc", "passwords", "connecting", "bitcoind"], "sentSegmentedWithoutStopsStemmed": ["first", "second", "start", "run", "systemctl", "statu", "clightn", "see", "leak", "bitcoind", "rpc", "password", "connect", "bitcoind"]}, {"number": 31952, "isCode": false, "isBlockQuote": false, "blockQuoteDepth": 0, "sent": "Of course, this should also be fixed upstream but I think it would be a general security improvement to restrict current user's access to process information when /proc access is restricted.", "sentSegmented": ["of", "course", "this", "should", "also", "be", "fixed", "upstream", "but", "i", "think", "it", "would", "be", "a", "general", "security", "improvement", "to", "restrict", "current", "user", "'s", "access", "to", "process", "information", "when", "/proc", "access", "is", "restricted"], "sentSegmentedWithoutStops": ["course", "also", "fixed", "upstream", "think", "would", "general", "security", "improvement", "restrict", "current", "user", "'s", "access", "process", "information", "/proc", "access", "restricted"], "sentSegmentedWithoutStopsStemmed": ["cours", "also", "fix", "upstream", "think", "would", "gener", "secur", "improv", "restrict", "current", "user", "'s", "access", "process", "inform", "/proc", "access", "restrict"]}]}